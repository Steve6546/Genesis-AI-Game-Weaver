# كيفية تشغيل واختبار مشروع Genesis AI Game Weaver

هذا الدليل يوفر خطوات مفصلة لتشغيل المشروع وتجربة الميزات الحالية.

## 1. المتطلبات الأساسية (Prerequisites)

قبل البدء، تأكد من أن لديك البيئة التالية مجهزة:

*   **Python:** إصدار 3.7 أو أحدث. يمكنك التحقق من إصدار Python لديك عن طريق تشغيل `python --version` أو `python3 --version` في الطرفية (Terminal/Command Prompt).
*   **Pip:** مدير حزم Python. عادةً ما يتم تثبيته مع Python. يمكنك التحقق منه عن طريق `pip --version` أو `pip3 --version`.
*   **مكتبة Pygame:** مكتبة أساسية لتطوير الألعاب ثنائية الأبعاد في Python. لتثبيتها، قم بتشغيل:
    ```bash
    pip install pygame
    ```
    أو إذا كنت تستخدم `pip3`:
    ```bash
    pip3 install pygame
    ```
*   **مكتبة jsonschema:** مكتبة للتحقق من صحة بيانات JSON مقابل مخطط محدد. لتثبيتها، قم بتشغيل:
    ```bash
    pip install jsonschema
    ```
    أو:
    ```bash
    pip3 install jsonschema
    ```
*   **(اختياري) Git:** إذا كنت قد حصلت على المشروع عن طريق استنساخه من مستودع Git.

## 2. الحصول على كود المشروع

إذا لم يكن لديك كود المشروع بعد، يمكنك الحصول عليه (إذا كان متاحًا في مستودع عام) أو التأكد من أنك في المجلد الصحيح إذا كان لديك بالفعل.

بافتراض أنك تعمل داخل بيئة OpenHands، فإن ملفات المشروع موجودة في المسار `/workspace/genesis_ai_game_weaver/`.

## 3. تشغيل المشروع (Running the Project)

يتم تشغيل المشروع من خلال الملف الرئيسي `main.py` باستخدام سطر الأوامر.

**الخطوة 1: الانتقال إلى مجلد المشروع**

افتح الطرفية (Terminal) وتوجه إلى المجلد الذي يحتوي على ملفات المشروع:
```bash
cd /workspace/genesis_ai_game_weaver
```

**الخطوة 2: تنفيذ البرنامج**

يحتوي `main.py` على عدة خيارات للتشغيل:

### أ. تشغيل لعبة Top-Down Shooter (المحاكاة الحالية):

هذا هو السيناريو الأكثر اكتمالاً للاختبار حاليًا. سيقوم البرنامج بتحميل ملف `faulty_game_schema.json` (الذي يحتوي على خطأ متعمد)، ثم سيقوم بمحاكاة تصحيح هذا الخطأ باستخدام دالة `generate_corrected_schema_from_prompt` التي تُرجع مخططًا جاهزًا للعبة Top-Down Shooter. بعد ذلك، سيتم تشغيل اللعبة بشكل تفاعلي.

```bash
python main.py --json_file faulty_game_schema.json --run_live
```

**ماذا تتوقع أن ترى:**
*   رسائل في الطرفية تشير إلى تحميل الملف، اكتشاف الخطأ، محاكاة التصحيح، والتحقق الناجح من المخطط المصحح.
*   نافذة لعبة Pygame تظهر بعنوان "Top-Down Shooter - Corrected (Simulated)".
*   **اللاعب:** مستطيل أخضر في أسفل منتصف الشاشة.
    *   **التحكم:** استخدم مفاتيح الأسهم (أعلى، أسفل، يمين، يسار) لتحريك اللاعب.
    *   **إطلاق النار:** اضغط على مفتاح `Space` لإطلاق مقذوفات دائرية سماوية اللون تتحرك للأعلى.
*   **الأعداء:** مستطيلان أحمران ثابتان في الجزء العلوي من الشاشة.
*   **المقذوفات:** عند الاصطدام بالأعداء، ستلاحظ رسائل اصطدام في الطرفية، وستنقص "صحة" العدو (غير مرئية حاليًا للأعداء، لكن يتم تتبعها). بعد عدة ضربات (افتراضيًا 3)، سيتم تدمير العدو (يختفي).
*   **نصوص على الشاشة:**
    *   قواعد اللعبة: "Top-Down Shooter!", "Use Arrow Keys to Move. Space to Shoot.", "Destroy the red enemies."
    *   صحة اللاعب: "Player Health: 10" (أو القيمة الحالية إذا تم تفعيل ضرر اللاعب لاحقًا).
*   **لإغلاق اللعبة:** أغلق نافذة Pygame أو اضغط `Ctrl+C` في الطرفية التي تشغل البرنامج.

### ب. تشغيل لعبة باستخدام مخطط `generated_game.json` (بدون تصحيح):

هذا الملف يحتوي على مخطط لعبة أبسط (عادةً لاعب يتحرك أفقيًا وعقبة تسقط).

```bash
python main.py --json_file generated_game.json --run_live
```

**ماذا تتوقع أن ترى:**
*   لعبة بسيطة تظهر لاعبًا (عادةً أزرق) يتحرك يمينًا ويسارًا، وعقبة (عادةً دائرة حمراء) تسقط من الأعلى وتعود للظهور.
*   رسائل اصطدام في الطرفية عند اصطدام اللاعب بالعقبة.

### ج. إنشاء صورة واحدة من اللعبة (بدون تشغيل تفاعلي):

إذا أردت فقط رؤية الإطار الأول من اللعبة وحفظه كصورة (باسم `rendered_game.png` افتراضيًا في نفس المجلد)، قم بإزالة الوسيط `--run_live`:

```bash
python main.py --json_file generated_game.json
```
أو للعبة الـ Top-Down Shooter (بعد التصحيح المحاكى):
```bash
python main.py --json_file faulty_game_schema.json
```
ستجد ملف `rendered_game.png` في مجلد `/workspace/genesis_ai_game_weaver/`.

### د. اختبار آلية اكتشاف الأخطاء وتصحيحها (بالمحاكاة):

عند تشغيل الأمر التالي:
```bash
python main.py --json_file faulty_game_schema.json --run_live
```
لاحظ المخرجات في الطرفية. ستشاهد:
1.  رسالة تفيد بأن `faulty_game_schema.json` يحتوي على خطأ (Schema validation error).
2.  رسالة تفيد بأن النظام يحاول تصحيح المخطط باستخدام Gemini (محاكاة).
3.  رسالة تفيد بأن المخطط المصحح (الذي هو مخطط Top-Down Shooter) تم التحقق منه بنجاح.
4.  ثم تبدأ اللعبة.

يمكنك فتح ملف `corrected_faulty_game_schema.json` لترى المخطط الذي تم "تصحيحه" وحفظه.

## 4. فهم المخرجات والملفات الناتجة

*   **الطرفية (Terminal Output):** توفر معلومات حول عملية التحميل، التحقق، التصحيح (المحاكى)، وأي أخطاء أو رسائل اصطدام أثناء اللعب.
*   **`rendered_game.png`:** يتم إنشاؤه/الكتابة فوقه إذا لم تستخدم `--run_live`. يمثل الإطار الأول من اللعبة.
*   **`corrected_faulty_game_schema.json`:** يتم إنشاؤه/الكتابة فوقه عندما يتم تصحيح مخطط خاطئ بنجاح (مثل `faulty_game_schema.json`).

## 5. استكشاف الأخطاء وإصلاحها (Troubleshooting - مبدئي)

*   **`ModuleNotFoundError: No module named 'pygame'` أو `'jsonschema'`:** تأكد من أنك قمت بتثبيت المكتبات المطلوبة (انظر القسم 1).
*   **اللعبة لا تبدأ أو تظهر أخطاء Pygame:** تأكد من أن بيئة العرض لديك تعمل بشكل صحيح. في بعض البيئات الخادومية (headless)، قد تحتاج إلى إعداد متغير بيئة مثل `SDL_VIDEODRIVER=dummy` إذا كنت لا تقوم بتشغيل الحلقة التفاعلية.
*   **أخطاء في مخطط اللعبة:** إذا قمت بتعديل ملفات JSON يدويًا وأدخلت خطأ، سيحاول مدقق المخطط اكتشافه. راجع رسالة الخطأ في الطرفية وقارن مخططك بـ `docs/GAME_SCHEMA_FORMAT.md`.

هذا الدليل يجب أن يساعدك على البدء في تشغيل وتجربة مشروع Genesis AI Game Weaver. لمزيد من التفاصيل حول كيفية عمل كل جزء، يرجى الرجوع إلى ملفات التوثيق الأخرى في مجلد `docs/`.
